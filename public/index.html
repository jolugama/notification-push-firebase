<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>firebase push notification</title>

    <link href='https://fonts.googleapis.com/css?family=Quicksand:300,400' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Lato:400,300' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="js/libs/plugins/mdtoast.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <link rel="stylesheet" href="css/sweetalert2.css">

</head>

<body>
    
    
    <div class="container" >
        <h1>PWA con notification push de firebase</h1>
        <p id="token"></p>
        <h1>Lorem Ipsum</h1>

        <p>
            <b>Sólo tienes que bajar con el scroll al 80% y saltará un modal si no tienes las notificaciones activadas. Debe pasar al menos 3 segundos</b>  
        </p>

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed a velit sed diam efficitur suscipit. Nunc
            pretium mattis velit, ut condimentum dui congue sed. Proin varius lorem felis, quis venenatis mauris
            bibendum vel. Aliquam convallis purus erat, et mollis elit iaculis in. Duis posuere ante sit amet sem
            aliquet, a tincidunt tortor tristique. Maecenas pellentesque quis quam ac cursus. Cras interdum maximus
            mauris, et luctus ex tincidunt ac. Aliquam luctus, diam at consequat sagittis, diam magna bibendum magna, id
            dignissim dui ipsum at risus. Vivamus dictum erat vitae faucibus vehicula. Praesent consequat laoreet justo
            et mattis. Cras cursus hendrerit ligula, ut consequat dolor vulputate vel. Nulla vitae metus mauris. Nulla
            fermentum ac enim id iaculis. Morbi ac diam vel augue volutpat ultrices.
        </p>

        <p>
            Ut eu metus arcu. Donec mattis sapien est, vel congue turpis mollis ac. Nam nec porta risus. Praesent mollis
            elit ante. Proin ut maximus mauris. In interdum lorem nec tortor facilisis, vestibulum semper leo porttitor.
            Sed vel nisl consectetur, rhoncus ligula sed, sagittis sem. Vivamus leo odio, hendrerit ornare felis
            pellentesque, pulvinar tristique eros. Pellentesque faucibus, ante vitae dictum cursus, arcu ligula viverra
            orci, in scelerisque sapien dolor vitae nisi. Proin ullamcorper mollis vehicula.
        </p>

        <p>
            Pellentesque justo orci, venenatis a efficitur eu, accumsan sed mi. Mauris sagittis justo efficitur, commodo
            nisi ut, pretium arcu. Suspendisse pretium nibh in vestibulum tempus. Morbi urna sapien, consequat vel
            interdum vel, pulvinar at urna. Maecenas nec eleifend ex, sit amet tincidunt metus. Fusce tortor risus,
            facilisis eu tortor sit amet, egestas facilisis dui. Quisque ut metus vel odio ultricies ultrices. Quisque
            pharetra scelerisque augue nec elementum.
        </p>

        <p>
            Donec vel nulla imperdiet, bibendum magna a, tincidunt est. Aliquam mattis erat vitae lectus venenatis, eget
            mollis dolor fringilla. Quisque ut imperdiet mauris. Quisque id ex fringilla leo sollicitudin faucibus.
            Vestibulum eget augue pretium, eleifend magna sit amet, convallis lectus. Praesent fringilla, augue in
            egestas malesuada, nisl massa vehicula lorem, vitae iaculis mi magna vel lacus. Sed condimentum quam sed
            malesuada efficitur. Sed fringilla sed odio eget dignissim. Nunc vehicula pellentesque fringilla. Aliquam eu
            enim eget elit ultricies suscipit. Praesent quis eros posuere, congue mauris rhoncus, tempus mi. Morbi
            tristique lorem blandit neque semper elementum. Nulla sapien nunc, ornare a elit in, lobortis pulvinar
            mauris. Praesent pretium mattis ex et placerat.
        </p>

        <p>
            Nullam cursus turpis vel mauris lacinia vestibulum. Sed congue iaculis cursus. Vivamus lacus metus, aliquam
            eu aliquam et, lobortis et massa. Suspendisse malesuada erat non lectus pretium posuere. Nam sed metus eu
            elit tincidunt tempus. Phasellus congue lorem mauris, ac commodo est feugiat vel. Curabitur vestibulum
            ligula vitae consequat faucibus. Donec consectetur ultricies lorem, ut finibus purus rutrum ac. Proin
            dignissim tristique odio, at elementum orci. Mauris ut posuere felis. Nullam ac volutpat nibh, ut posuere
            enim. Quisque ut aliquam ex. Nulla ornare ligula ac tempus malesuada. Aliquam accumsan ligula sit amet ipsum
            mattis, quis sodales urna placerat. Vivamus semper metus ut tincidunt aliquam.
        </p>
    </div>



    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-messaging.js"></script>
    <script>
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        var firebaseConfig = {
            apiKey: "AIzaSyDzCa49qFHdSHVPCAGjSkbg0otzfdYYdNk",
            authDomain: "mypwa-8c271.firebaseapp.com",
            projectId: "mypwa-8c271",
            storageBucket: "mypwa-8c271.appspot.com",
            messagingSenderId: "475764615194",
            appId: "1:475764615194:web:2db636ff8a5588b2f9c9a3",
            measurementId: "G-3BQG8M4FLW"
        };
        firebase.initializeApp(firebaseConfig);
        const messaging = firebase.messaging();

        function IntitalizeFireBaseMessaging() {
            messaging
                .requestPermission()
                .then(function () {
                    console.log("Notification Permission");
                    return messaging.getToken();
                })
                .then(function (token) {
                    console.log("Token : " + token);
                    document.getElementById("token").innerHTML = token;


                })
                .catch(function (reason) {
                    console.log(reason);
                });
        }

        messaging.onMessage(function (payload) {
            console.log(payload);
            const notificationOption = {
                body: payload.notification.body,
                icon: payload.notification.icon
            };

            if (Notification.permission === "granted") {
                var notification = new Notification(payload.notification.title, notificationOption);

                notification.onclick = function (ev) {
                    ev.preventDefault();
                    window.open(payload.notification.click_action, '_blank');
                    notification.close();
                }
            }

        });

    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/pouchdb@7.2.1/dist/pouchdb.min.js"></script>
    <script src="js/libs/plugins/mdtoast.min.js"></script>
    <script src="js/libs/plugins/sweetalert2.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/app.js"></script>

</body>

</html>